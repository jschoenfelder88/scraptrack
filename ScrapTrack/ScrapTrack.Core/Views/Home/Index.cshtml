@model ScrapTrack.Core.Models.DashboardViewModel
@{
    ViewData["Title"] = "Dashboard";
}

<style>
    .tabs {
        overflow: hidden;
        border: 1px solid #ccc;
        border-top-left-radius: 1rem;
        border-top-right-radius: 1rem;
        background-color: #585858;
    }

        .tabs button {
            background-color: inherit;
            color: #FFF;
            font-weight: 600;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
        }

    .tabcontent {
        display: none;
        min-height: 200px;
        padding-bottom: 2rem;
        border: 1px solid #ccc;
        border-bottom-left-radius: 1rem;
        border-bottom-right-radius: 1rem;
        border-top: none;
    }

    .tablinks.active {
        color: #76D9FF;
    }

    .tabcontent.active {
        display: block;
    }
    .mmodal-btn {
        float: right;
        width: 9rem;
    }

    .mmodal-partialview {
        display: none;
    }
    .quickaction-link {
        float: left;
        margin-bottom: .5rem;
    }
</style>

<div class="container">
    <div class="row">
        <div class="col-md-4">
            <h3>Welcome, @User.Identity.Name!</h3>
            <hr />
            <h4>Quick Actions</h4>
            <div class="container quickaction">
                <div class="row">
                    <btn id="btnAddVolunteer" class="btn btn-success mmodal-btn quickaction-link">Add Volunteer</btn>
                </div>
                <div class="row">
                    <btn id="btnAddItem" class="btn btn-success mmodal-btn quickaction-link">Add Item</btn>
                </div>
            </div>
        </div>
        <div class="col-md-8">
            <div class="tabs">
                <button class="tablinks active">Transactions</button>
                <button class="tablinks">Volunteers</button>
                <button class="tablinks">Items</button>
            </div>
            <div class="tabcontent-container">
                <div id="transactions" class="tabcontent active">
                </div>
                <div id="volunteers" class="tabcontent">
                    @Html.Partial("~/Views/Volunteers/_ListVolunteers.cshtml", Model.VolunteerList)
                </div>
                <div id="items" class="tabcontent">
                    @Html.Partial("~/Views/Items/_ListItems.cshtml", Model.ItemList)
                </div>
            </div>
        </div>
    </div>
</div>    

<div class="mmodal">
    <div class="mmodal-content">
        <span class="close">&times;</span>
        <div id="partial-content">
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {

        var tabs = $('.tablinks');
        var tabsContent = $('.tabcontent');
        var activeTab = $('.tablinks.active')[0];
        var activeTabContent = $('.tabcontent.active')[0];

        $('.tablinks').on('click', function (e) {
            e.preventDefault();
            if (activeTab !== e.target) {
                activeTab.className = activeTab.className.replace(' active', '');
                e.target.className += ' active';
                activeTab = $('.tablinks.active')[0];

                for (i = 0; i < tabsContent.length; i++) {
                    if (tabs[i] === e.target) {
                        activeTabContent.className = activeTabContent.className.replace(' active', '');
                        tabsContent[i].className += ' active';
                        activeTabContent = tabsContent[i];
                    }
                }
            }
        });

        $('#partial-content').on('click', '#submitVolunteerDetails', function (e) {
            e.preventDefault();
            $.ajax({
                type: "POST",
                url: '@Url.Action("Create", "Volunteers")',
                data: $('form').serialize(),
                success: function (result) {
                    console.log(result);
                    $("#partial-content").html(result);
                },
                error: function (result) {
                    console.log(result);
                }
            });
        });

        $('#partial-content').on('click', '#submitItemDetails', function (e) {
            e.preventDefault();
            $.ajax({
                type: "POST",
                url: '@Url.Action("Create", "Items")',
                data: $('form').serialize(),
                success: function (result) {
                    $("#partial-content").html(result);
                },
                error: function (result) {
                    console.log(result);
                }
            });
        });

        $('#btnAddVolunteer').on('click', function (e) {
            e.preventDefault();
            $.ajax({
                type: 'GET',
                url: '@Url.Action("Create", "Volunteers")',
                success: function (result) {
                    $("#partial-content").html(result);
                }
            });
        });

        $('#btnAddItem').on('click', function (e) {
            e.preventDefault();
            $.ajax({
                type: 'GET',
                url: '@Url.Action("Create", "Items")',
                success: function (result) {
                    $("#partial-content").html(result);
                }
            });
        });
    });
</script>
